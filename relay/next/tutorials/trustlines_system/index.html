<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.69">
<link rel="search" type="application/opensearchdescription+xml" title="Trustlines Developer Docs" href="/opensearch.xml">
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var t="https://stats.trustlines.network/";_paq.push(["setTrackerUrl",t+"matomo.php"]),_paq.push(["setSiteId","4"]);var e=document,a=e.createElement("script"),p=e.getElementsByTagName("script")[0];a.type="text/javascript",a.async=!0,a.src=t+"matomo.js",p.parentNode.insertBefore(a,p)}()</script><title data-react-helmet="true">Running the Trustlines system | Trustlines Developer Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-relay-current"><meta data-react-helmet="true" property="og:title" content="Running the Trustlines system | Trustlines Developer Docs"><meta data-react-helmet="true" name="description" content="This document explains how to run your own trustlines network relay server infrastructure. We will walk you through setting up a relay server and all dependent components. The current documentation is written for a Debian-based Linux system."><meta data-react-helmet="true" property="og:description" content="This document explains how to run your own trustlines network relay server infrastructure. We will walk you through setting up a relay server and all dependent components. The current documentation is written for a Debian-based Linux system."><meta data-react-helmet="true" property="og:url" content="https://dev.trustlines.network/relay/next/tutorials/trustlines_system"><link data-react-helmet="true" rel="shortcut icon" href="/img/tl-favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://dev.trustlines.network/relay/next/tutorials/trustlines_system"><link rel="stylesheet" href="/styles.6e41a71e.css">
<link rel="preload" href="/styles.95fb5d7f.js" as="script">
<link rel="preload" href="/runtime~main.3386d8af.js" as="script">
<link rel="preload" href="/main.bd2ac00f.js" as="script">
<link rel="preload" href="/1.edca0a28.js" as="script">
<link rel="preload" href="/5be9315b.fa8b01c8.js" as="script">
<link rel="preload" href="/631.c5009afe.js" as="script">
<link rel="preload" href="/ef0253de.33795393.js" as="script">
<link rel="preload" href="/630.db94fc0a.js" as="script">
<link rel="preload" href="/bcce04cb.a0eb7659.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/tl-favicon.png" alt="Trustlines logo"><strong class="navbar__title">Trustlines Dev Docs</strong></a><a class="navbar__item navbar__link" href="/blockchain/tlbc">Blockchain</a><a class="navbar__item navbar__link" href="/contracts/introduction">Contracts</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/relay/introduction">Relay</a><a class="navbar__item navbar__link" href="/clientlib/introduction">Clientlib</a><a class="navbar__item navbar__link" href="/mobileapp/introduction">Trustlines App</a><a class="navbar__item navbar__link" href="/docs/contributing">Contributing</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/relay/next/introduction">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/relay/next/tutorials/trustlines_system">Next</a></li><li><a class="dropdown__link" href="/relay/tutorials/trustlines_system">0.21.0</a></li><li><a class="dropdown__link" href="/relay/0.20.1/tutorials/trustlines_system">0.20.1</a></li></ul></div><a href="https://github.com/trustlines-protocol/relay" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/tl-favicon.png" alt="Trustlines logo"><strong class="navbar__title">Trustlines Dev Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/relay/next/tutorials/trustlines_system">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/relay/tutorials/trustlines_system">0.21.0</a></li><li class="menu__list-item"><a class="menu__link" href="/relay/0.20.1/tutorials/trustlines_system">0.20.1</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/blockchain/tlbc">Blockchain</a></li><li class="menu__list-item"><a class="menu__link" href="/contracts/introduction">Contracts</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/relay/introduction">Relay</a></li><li class="menu__list-item"><a class="menu__link" href="/clientlib/introduction">Clientlib</a></li><li class="menu__list-item"><a class="menu__link" href="/mobileapp/introduction">Trustlines App</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/contributing">Contributing</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Relay</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/contributing">Contributing</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/getting_started/docker">Via docker-compose</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/getting_started/manual">Manual Setup</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Developing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/develop/develop">Start developing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/develop/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/develop/pre_commit_hooks">Pre-commit hooks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/develop/dependencies">Dependencies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/develop/release">Release</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/relay/next/tutorials/trustlines_system">Running the Trustlines system</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/tutorials/trustlines_tlbc_system">Running the Relay with a TLBC-node (with docker)</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">REST API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/api/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Endpoints</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/api/network">Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/api/user">User</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/relay/next/api/miscellaneous">Miscellaneous</a></li></ul></li></ul></li><li class="menu__list-item"><a href="https://github.com/trustlines-protocol/relay/blob/master/CHANGELOG.rst" target="_blank" rel="noreferrer noopener" class="menu__link">Release Notes</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Trustlines Developer Docs <strong>Next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/relay/tutorials/trustlines_system">latest version</a></strong> (0.21.0).</div></div><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">Running the Trustlines system</h1></header><div class="markdown"><p>This document explains how to run your own <a href="https://trustlines.network/" target="_blank" rel="noopener noreferrer">trustlines network</a> relay server infrastructure. We will walk you through setting up a relay server and all dependent components. The current documentation is written for a Debian-based Linux system.</p><p>If you are low on time, you may jump to the description of the <a href="/relay/getting_started/docker">docker-compose based setup</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dependencies"></a>Dependencies<a class="hash-link" href="#dependencies" title="Direct link to heading">#</a></h2><p>Since the trustlines infrastructure components are implemented in python 3, you need to install relevant dependencies. You will need at least python 3.6.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt install build-essential python3-dev python3-venv pkg-config git libpq-dev</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The installation instructions assume you create a dedicated user account and put
files directly into the user&#x27;s home directory. Else, adapt the paths to your needs!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="trustlines-blockchain"></a>Trustlines Blockchain<a class="hash-link" href="#trustlines-blockchain" title="Direct link to heading">#</a></h3><p>You need to run our modified OpenEthereum node, which provides the JSONRPC API to the relay
server and the indexer. The documentation on how to run it can be found <a href="/blockchain/tlbc">here</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="contracts"></a>Contracts<a class="hash-link" href="#contracts" title="Direct link to heading">#</a></h3><p>The <a href="https://github.com/trustlines-protocol/contracts" target="_blank" rel="noopener noreferrer">trustlines-contracts
repository</a> contains the
solidity contracts to be deployed on the blockchain and a commandline tool to deploy the contracts. The
<a href="/contracts/deploy_tools/introduction">deploy tools section</a> in the contracts docs contains more information on how to deploy the contracts.
The tool will return the addresses of the deployed contracts. You need to provide that information to the relay server with as json file <code>addresses.json</code> with the following format:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;networks&quot;:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  [&lt;list of currency network addresses&gt;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The directory called <code>config/</code> contains already prepared files for the different
networks of the foundation. Those include a list of addresses for the registered
currency networks. You can copy one of those files and adopt it to your needs,
in case you want to add custom deployed networks.</p><p>We assume from now on that the contracts have already been deployed
and that the <code>addresses.json</code> file has been copied to the user&#x27;s home directory.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="postgresql"></a>PostgreSQL<a class="hash-link" href="#postgresql" title="Direct link to heading">#</a></h3><p>The trustlines system uses a PostgreSQL database to store some user data and to
keep a synchronized view on the relevant state from the blockchain.</p><p>Install PostgreSQL with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt install postgresql</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After this, a database user must be created. Please use a real password:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo -u postgres psql &lt;&lt;EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CREATE USER trustlines WITH PASSWORD &#x27;choose-a-password-here&#x27;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ALTER USER trustlines CREATEDB;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Next, the postgres environment should be configured for the account running
the relay server:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">echo &gt;&gt;~/.pgpass &#x27;localhost:5432:*:trustlines:choose-a-password-here&#x27;; chmod 0600 ~/.pgpass</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cat &gt;&gt;~/.bashrc &lt;&lt;EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">export PGUSER=trustlines</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">export PGHOST=localhost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">export PGDATABASE=trustlinesdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>After logging in again, in order to have the environment variables set, the user
should be able to create the database:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">createdb trustlinesdb</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The rest of this tutorial assumes that the user running the relay and
py-eth-index related commands has a working postgresql environment
configured.  All programs consider the <code>PG*</code> environment variables
(like <code>PGHOST</code>, <code>PGUSER</code>, ...) and will read <code>~/.pgpass</code> for
information about passwords. The <a href="#py-eth-index">py-eth-index section</a>
describes how to create the trustlines specific tables.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="creating-a-virtualenv"></a>Creating a Virtualenv<a class="hash-link" href="#creating-a-virtualenv" title="Direct link to heading">#</a></h3><p>Run the following command to create a virtualenv:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p ~/opt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">python3 -mvenv ~/opt/trustlines-system</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/trustlines-system/bin/pip install -U pip wheel setuptools</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>And activate the virtualenv with</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">source ~/opt/trustlines-system/bin/activate</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This will add ~/opt/trustlines-system/bin to <code>PATH</code>. The following
steps assumes an acticated virtualenv.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="py-eth-index"></a>Py-eth-index<a class="hash-link" href="#py-eth-index" title="Direct link to heading">#</a></h3><p>The <a href="https://github.com/trustlines-protocol/py-eth-index" target="_blank" rel="noopener noreferrer">py-eth-index repository</a>
contains a helper program that synchronizes the relevant information from the
blockchain into a postgresql database.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="installation-of-py-eth-index"></a>Installation of py-eth-index<a class="hash-link" href="#installation-of-py-eth-index" title="Direct link to heading">#</a></h4><p>Clone the git repository:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git clone https://github.com/trustlines-protocol/py-eth-index</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>And install py-eth-index</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/py-eth-index</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pip install -c constraints.txt .</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="initializing-the-database"></a>Initializing the Database<a class="hash-link" href="#initializing-the-database" title="Direct link to heading">#</a></h4><p>After the database has been created, it must be initialized. This can be done with the following command:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ethindex createtables</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="importing-the-abis"></a>Importing the ABIs<a class="hash-link" href="#importing-the-abis" title="Direct link to heading">#</a></h4><p>We need to import the ABIs from the trustline-contracts. Trustlines-contracts is
installed as a dependency of the relay server. Please run the following only
after you have installed the relay server.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cp ~/opt/trustlines-system/trustlines-contracts/build/contracts.json ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">~/opt/py-eth-index/bin/ethindex importabi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>If you did not follow this document to install the relay but prefer an
alternative approach (like via
<a href="/relay/getting_started/docker">docker-compose</a>), checkout <a href="#get-contract-abis">this
section</a> about the different options to retrieve the
<code>contracts.json</code> file.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="importing-events"></a>Importing Events<a class="hash-link" href="#importing-events" title="Direct link to heading">#</a></h4><p>The following command will start importing all relevant events into the postgres
database:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ethindex runsync</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This program will run forever.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="relay-server"></a>Relay Server<a class="hash-link" href="#relay-server" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="installation-of-the-relay-server"></a>Installation of the Relay Server<a class="hash-link" href="#installation-of-the-relay-server" title="Direct link to heading">#</a></h4><p>Clone the git repository and install it:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">git clone https://github.com/trustlines-protocol/relay</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/relay</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pip install -r requirements.txt .</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="running-the-relay-server"></a>Running the Relay Server<a class="hash-link" href="#running-the-relay-server" title="Direct link to heading">#</a></h4><p>The relay server needs the addresses of the deployed contracts. In case you&#x27;ve
deployed your own contracts, please copy addresses.json to <code>~</code>.</p><p>We will also need a config file. You can use the one from the git checkout:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cp ~/relay/config.toml ~</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The relay server reads both files from the current directory per default,
so we need to start it where those files have been copied to:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tl-relay</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>However, this behaviour can be changed, you can check the options with:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">tl-relay --help</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>The relay server needs access to the OpenEthereum node and the PostgreSQL database.
<code>ethindex runsync</code> also has to be running for a fully functioning system.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="signing-transactions"></a>Signing Transactions<a class="hash-link" href="#signing-transactions" title="Direct link to heading">#</a></h4><p>The relay server needs to sign transactions. The default behaviour is
to rely on a OpenEthereum node with an unlocked account, that signs
transactions.</p><p>Alternatively the relay can sign transactions locally itself with a
configured key. For this approach add the following section to the
configuration file and adjust the values. The key is expected to be
encrypted in a keystore file. To unlock the key, a password file in
clear text must be provided as well.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-toml codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[account]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">keystore_path = &quot;keystore.json&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">keystore_password_path = &quot;keystore-password.txt&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="get-contract-abis"></a>Get Contract ABIs<a class="hash-link" href="#get-contract-abis" title="Direct link to heading">#</a></h4><p>The file with the compiled contracts (<code>contracts.json</code>) is bundled within
multiple packages on different platforms. Please checkout that approach that
fits the best for your setup from list below.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pypi"></a>PyPI<a class="hash-link" href="#pypi" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pip download trustlines-contracts-bin --dest /tmp </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> --extract --file /tmp/trustlines-contracts-bin*.tar.gz --no-anchored </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;contracts.json&#x27;</span><span class="token plain"> --strip-components </span><span class="token number" style="color:rgb(247, 140, 108)">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>To download a specific version, add the version directly behind the package name
separated with a <code>==</code> (e.g. <code>trustlines-contracts-bin==1.1.2</code>).</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="npm"></a>NPM<a class="hash-link" href="#npm" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -L </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">npm</span><span class="token variable" style="color:rgb(191, 199, 213)"> view trustlines-contracts-abi dist.tarball</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> --extract --gzip --no-anchored </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;contracts.json&#x27;</span><span class="token plain"> --strip-components </span><span class="token number" style="color:rgb(247, 140, 108)">1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>To download a specific version, add the version directly behind the package name
separated with a <code>@</code> (e.g. <code>trustlines-contracts-abi@1.1.2</code>).</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dockerhub"></a>DockerHub<a class="hash-link" href="#dockerhub" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-bash codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --rm --volume </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">pwd</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain">:/here --entrypoint /bin/bash trustlines/relay -c </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cp /opt/relay/trustlines-contracts/build/contracts.json /here&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>To download a specific version in relation of the relay, add the wished image
tag behind the image name (e.g. <code>trustlines/relay:0.12.1</code>).</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/trustlines-protocol/tl-dev-docs/edit/master/relay/tutorials/trustlines_system.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/relay/next/develop/release"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Release</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/relay/next/tutorials/trustlines_tlbc_system"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Running the Relay with a TLBC-node (with docker) Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dependencies" class="table-of-contents__link">Dependencies</a><ul><li><a href="#trustlines-blockchain" class="table-of-contents__link">Trustlines Blockchain</a></li><li><a href="#contracts" class="table-of-contents__link">Contracts</a></li><li><a href="#postgresql" class="table-of-contents__link">PostgreSQL</a></li><li><a href="#creating-a-virtualenv" class="table-of-contents__link">Creating a Virtualenv</a></li><li><a href="#py-eth-index" class="table-of-contents__link">Py-eth-index</a></li><li><a href="#relay-server" class="table-of-contents__link">Relay Server</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Websites</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.trustlines.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Blog</a></li><li class="footer__item"><a href="https://trustlines.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Foundation</a></li><li class="footer__item"><a href="https://docs.trustlines.network//" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines User Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://forum.trustlines.network/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Forum</a></li><li class="footer__item"><a href="http://eepurl.com/gHqYyX" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Newsletter</a></li><li class="footer__item"><a href="https://t.me/trustlines_network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Network in Telegram</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/trustlines-protocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines on github</a></li><li class="footer__item"><a href="https://gitter.im/trustlines/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trustlines Technical Chat</a></li><li class="footer__item"><a href="https://docs.trustlines.network/docs/resources/community_communications_guide.html#6-communication-and-trustlines-network-channels-1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact channels</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 Trustlines.</div></div></div></footer></div>
<script src="/styles.95fb5d7f.js"></script>
<script src="/runtime~main.3386d8af.js"></script>
<script src="/main.bd2ac00f.js"></script>
<script src="/1.edca0a28.js"></script>
<script src="/5be9315b.fa8b01c8.js"></script>
<script src="/631.c5009afe.js"></script>
<script src="/ef0253de.33795393.js"></script>
<script src="/630.db94fc0a.js"></script>
<script src="/bcce04cb.a0eb7659.js"></script>
</body>
</html>